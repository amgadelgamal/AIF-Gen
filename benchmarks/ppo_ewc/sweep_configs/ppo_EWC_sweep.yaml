name: "continual_ppo_ewc_sweep"
method: random
metric:
  name: eval_loss
  goal: minimize
parameters:
  learning_rate:
    distribution: uniform
    min: 1e-7
    max: 1e-5
  num_train_epochs:
    values: [1, 2, 3]
  per_device_train_batch_size:
    values: [1, 2, 4]
  gradient_checkpointing:
    values: [true, false]
  eval_steps:
    values: [50, 100]
  ewc_lambda:
    distribution: uniform
    min: 10.0
    max: 200.0
  ewc_importance_decay:
    distribution: uniform
    min: 0.1
    max: 1.0
  fisher_estimation_samples:
    values: [20, 50, 100, 200]
command:
  - uv run
  - benchmarks/ppo_ewc/ppo_EWC_continual.py
  - --dataset_name
  - debug
  - --model_name_or_path
  - Qwen/Qwen2-0.5B-Instruct
  - --learning_rate
  - ${learning_rate}
  - --num_train_epochs
  - ${num_train_epochs}
  - --per_device_train_batch_size
  - ${per_device_train_batch_size}
  - --gradient_checkpointing
  - ${gradient_checkpointing}
  - --eval_strategy
  - steps
  - --eval_steps
  - ${eval_steps}
  - --logging_steps
  - 25
  - --run_output_dir
  - Qwen2-0.5B-DPO-EWC
  - --no_remove_unused_columns
  - --ewc_lambda
  - ${ewc_lambda}
  - --ewc_importance_decay
  - ${ewc_importance_decay}
  - --fisher_estimation_samples
  - ${fisher_estimation_samples}
